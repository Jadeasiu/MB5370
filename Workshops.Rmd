---
title: "Workshops"
output: html_document
date: "2023-05-07"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
install.packages("tidyverse")
library(tidyverse)
```

The mpg data frame found in ggplot2 is a dataset with observations (234 rows of data) and variables (in the columns)
```{r}
mpg
#disp = engine size, hwy = fuel efficiency in miles per gallon 
```
## Plotting with ggplot2
#ggplot template 
ggplot(data = <DATA>) + 
  <GEOM_FUNCTION>(mapping = aes(<MAPPINGS>))
```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy))
```
## Mapping aesthetics 
Change point colour by class
```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, colour = class))
```
Change pint size by class
```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, size = class))
```
Using size for a discrete value is not advised. Don’t plot a variable which is not continuous to a continuous aesthetic like size

Change point transparency by class (alpha)
```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, alpha = class))
```
Change point shape by class.
```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, shape = class))
```
```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy), color = "blue")
```
```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, colour = displ < 5)
```
## Facet and Panel Plots 
To facet your plot using a single variable, use facet_wrap(). Only use facet_wrap() for discrete variables.
```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) + 
  facet_wrap(~ class, nrow = 2)
```
If you want to plot more than one variable, then use facet_grid(). Use ~ to split them up.
```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) + 
  facet_grid(drv ~ cyl)
#categorzing the plots into drive and cylindical size 
```
Excersize 1: Read ?facet_wrap
```{r}
?facet_wrap
```
* nrow & ncol determine the number of rows and columns 
* as.table is set to default TRUE, meaning that the facets are laid out like a table with highest values at the bottom-right
* dir determines the direction. EIther "h" for horizontal, or the default "v" for vertical. 

## Fitting Simple Lines
Using visual objects to represent the data. 

To display data as points, use geom_point()
```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy))
```
To display the same data as a smooth line fit through the points use geom_smooth()
```{r}
ggplot(data = mpg) + 
  geom_smooth(mapping = aes(x = displ, y = hwy))
```
You can change the line type and can use a variable to control it.
```{r}
ggplot(data = mpg) + 
  geom_smooth(mapping = aes(x = displ, y = hwy, linetype = drv))
```
Here we will use the group argument to show that our data is in fact grouped - it won’t add a new legend but can easily be used to vary your plots by the discrete variable.

Set the group aesthetic to a categorical variable to draw multiple objects
```{r}
ggplot(data = mpg) +
  geom_smooth(mapping = aes(x = displ, y = hwy, group = drv))
```
Change the color of each line based on drv value
```{r}
ggplot(data = mpg) +
  geom_smooth(
    mapping = aes(x = displ, y = hwy, color = drv),
    show.legend = FALSE,
  )
```
Here we will plot multiple geoms on the single plot
```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) +
  geom_smooth(mapping = aes(x = displ, y = hwy))
```
Global mappings are applied to every subsequent geom 
```{r}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point() + 
  geom_smooth()
```
Use mappings in specific layers to enable the display of different aesthetics in different layers. Note how the line is not styled by class but you can style the points by themselves.
```{r}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point(mapping = aes(color = class)) + 
  geom_smooth()
```
The same goes if you want to specify different data for each layer. Here we use a filter (class = "subcompact") to select a subset of the data and plot only that subset. 
```{r}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point(mapping = aes(color = class)) + 
  geom_smooth(data = filter(mpg, class == "subcompact"), se = FALSE)
```
Excersize: 
1. What geom would you use to draw a line chart? A boxplot? A histogram? An area chart?
* for a line char: geom_line()
* for a boxplot: geom_boxplot()
* for a histogram: geom_histogram()
* for an area chart: geom_ribbon()
  
2. Run this code in your head and predict what the output will look like. Then, run the code in R and check your predictions.
```{r}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_line()
ggplot(data = mpg, mapping = aes(x = class, y = hwy)) + 
  geom_boxplot()
ggplot(data = mpg, mapping = aes(x = hwy)) + 
  geom_histogram()
ggplot(data = mpg) + 
  geom_ribbon(aes(displ, ymin = 0, ymax = hwy, fill = drv, color = drv))

```
3. Will these two graphs look different? Why/why not?
* No they will look the same, because the second one is basically just hte duplicated version of the first one whic is globalized but they hold the exact same information. 

## Transformation and Stats
The diamonds dataset comes in ggplot2 and contains information about ~54,000 diamonds, including the price, carat, color, clarity, and cut of each diamond.

### Plotting Statistics 
```{r}
ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut))
```
More diamonds are available with high quality cuts than low quality cuts 

Geoms and stats can be used interchangebly
```{r}
ggplot(data = diamonds) + 
  stat_count(mapping = aes(x = cut))
```
### Overriding defaults in ggplot2
Change the default stat (which is a count, a summary) to identity (which is the raw value of a variable).
```{r}
demo <- tribble(
  ~cut,         ~freq,
  "Fair",       1610,
  "Good",       4906,
  "Very Good",  12082,
  "Premium",    13791,
  "Ideal",      21551
)
demo

ggplot(data = demo) +
  geom_bar(mapping = aes(x = cut, y = freq), stat = "identity")
```
You can also override a default mapping from transformed variables to aesthetics. For instance, you could display a bar chart of proportion of your total diamond dataset rather than a count.
```{r}
ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, y = stat(prop), group = 1))
```
### Plotting Statistical Details 
Use stat_summary to show a lot more detail about transformations in your plot. 
```{r}
ggplot(data = diamonds) + 
  stat_summary(
    mapping = aes(x = cut, y = depth),
    fun.min = min,
    fun.max = max,
    fun = median
  )
```
### Positional Adjustments 
You can use colour or fill to change aspects of bar colours

```{r}
ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, colour = cut))
ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, fill = cut))
#colour = cut only outlines the bar chart whereas fill = cut fills the entire bar
```
```{r}
ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, fill = clarity))
```
If you use position = "identity", you will be able to place each object exactly where it falls in the context of the graph. This is vital for point charts like scatter plots but makes a mess in a bar plot situation by showing too much information (a bar plot generally summarises information). We will need to alter the bar aesthetic.
```{r}
#To alter transparency (alpha)
ggplot(data = diamonds, mapping = aes(x = cut, fill = clarity)) + 
  geom_bar(alpha = 1/5, position = "identity")

#To color the bar outlines with no fill color
ggplot(data = diamonds, mapping = aes(x = cut, colour = clarity)) + 
  geom_bar(fill = NA, position = "identity")
```
Position = "fill" works like stacking, but makes each set of stacked bars the same height.
```{r}
ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, fill = clarity), position = "fill")
```
Position = "dodge" places overlapping objects directly beside one another.
```{r}
ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, fill = clarity), position = "dodge")
```
Position = "jitter" adds a small amount of random noise to each point to avoid overplotting when points overlap. This is useful for scatterplots but not barplots.
```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy), position = "jitter")
```
## The Layered Grammer of Graphics 

### Template 
ggplot(data = <DATA>) + 
  <GEOM_FUNCTION>(
     mapping = aes(<MAPPINGS>),
     stat = <STAT>, 
     position = <POSITION>
  ) +
  <FACET_FUNCTION>
  
## Assignment: Plot Deconstruction 


# Workshop 2 – Using ggplot2 for communication

###Labels 
In ggplot2, you add labels with the labs() function. 
Titles 
```{r}
ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(color = class)) +
  geom_smooth(se = FALSE) +
  labs(title = "Fuel efficiency generally decreases with engine size")
```

Subtitle adds additional detail in a smaller font beneath the title and caption adds text at the bottom right of the plot 
Caption adds text at the bottom right of the plot, often used to describe the source of the data.
```{r}
ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(color = class)) +
  geom_smooth(se = FALSE) +
  labs(
    title = "Fuel efficiency generally decreases with engine size",
    subtitle = "Two seaters (sports cars) are an exception because of their light weight",
    caption = "Data from fueleconomy.gov"
  )
```
You can also use labs() to replace axis labels and legend titles
```{r}
ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(colour = class)) +
  geom_smooth(se = FALSE) +
  labs(
    x = "Engine displacement (L)",
    y = "Highway fuel economy (mpg)",
    colour = "Car type"
  )
```
### Annotations
you can use geom_text() to add textual labels to your plots. This works in the same way as geom_point() but rather than a shape geometry it can add a label
```{r}
best_in_class <- mpg %>%
  group_by(class) %>%
  filter(row_number(desc(hwy)) == 1)

ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(colour = class)) +
  geom_text(aes(label = model), data = best_in_class)
```
###Scales
```{r}
#ggplot automatically adds default scales 
ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(colour = class))
```
If you want to tweak the default scales you can do it by offering values to the scale parameters
```{r}
ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(colour = class)) +
  scale_x_continuous("displ", 3) +
  scale_y_continuous("hwy", 2) +
  scale_colour_discrete("class", 9)
#no clue what is happening, it is just chaning the numbers 
```
###Axis Ticks 
You can also change the ticks on your axes. Breaks controls the position of the ticks and you can use labels as an argument to change the text label associated with ticks
```{r}
ggplot(mpg, aes(displ, hwy)) +
  geom_point() +
  scale_y_continuous(breaks = seq(15, 40, by = 5))
#this changes the spacing on the axis, first number is the start number, second is the max number and by is how much it is increasing by 

seq(15, 40, by = 5)

ggplot(mpg, aes(displ, hwy)) +
  geom_point() +
  scale_x_continuous(labels = NULL) +
  scale_y_continuous(labels = NULL)
# you can alos use labels = NULL to surpress the labels altogether
```
### Legends and Colour Schemes
Sometimes you might want to change the position of your legend, perhaps to make the plot itself as wide as possible (e.g. put the legend underneath) or to hide it all together. 

To control the overall position of the legend, you need to use a theme() setting. You can also use legend.position = "none" to suppress the display of the legend altogether
```{r}
base <- ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(colour = class))

base + theme(legend.position = "left")
base + theme(legend.position = "top")
base + theme(legend.position = "bottom")
base + theme(legend.position = "right") # the default
#code for positioning the legend in different places. Create the base then add it to the theme 
```
###Replacing a Scale
There are two types of scales you’re mostly likely to want to switch out: continuous position scales and colour scales.
It’s very useful to plot transformations of your variable
```{r}
ggplot(diamonds, aes(carat, price)) +
  geom_bin2d() + 
  scale_x_log10() + 
  scale_y_log10()
```
Another scale that is frequently customised is the colour scale. In fact, from a data visualisation point of you, this one is among the most important changes you can make to a base ggplot.
```{r}
ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(color = drv))

ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(color = drv)) +
  scale_colour_brewer(palette = "Set1")
```
If there are just a few colours, you can add a redundant shape mapping. This will also help ensure your plot is interpretable in black and white.
```{r}
ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(color = drv, shape = drv)) +
  scale_colour_brewer(palette = "Set1")
```
When you have a predefined colours you want to use you can set them yourself, using scale_colour_manual()
```{r}
presidential %>%
  mutate(id = 33 + row_number()) %>%
  ggplot(aes(start, id, colour = party)) +
    geom_point() +
    geom_segment(aes(xend = end, yend = id)) +
    scale_colour_manual(values = c(Republican = "red", Democratic = "blue"))
```

To use one of the most popular colour schemes, simply use scale_colour_viridis() provided by the viridis package
```{r}
install.packages('viridis')
install.packages('hexbin')
library(viridis)
library(hexbin)

df <- tibble( # note we're just making a fake dataset so we can plot it
  x = rnorm(10000),
  y = rnorm(10000)
)
ggplot(df, aes(x, y)) +
  geom_hex() + # a new geom!
  coord_fixed()

ggplot(df, aes(x, y)) +
  geom_hex() +
  viridis::scale_fill_viridis() +
  coord_fixed()
```
### Themes
Themes allow you to change some or all of the non-data elements of your plot with a theme.
ggplot2 has eight themes by default.
```{r}
ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(color = class)) +
  geom_smooth(se = FALSE) +
  theme_bw()

ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(color = class)) +
  geom_smooth(se = FALSE) +
  theme_light()

ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(color = class)) +
  geom_smooth(se = FALSE) +
  theme_classic()

ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(color = class)) +
  geom_smooth(se = FALSE) +
  theme_dark()
```
```{r}
theme (panel.border = element_blank(),
        panel.grid.minor.x = element_blank(),
        panel.grid.minor.y = element_blank(),
        legend.position="bottom",
        legend.title=element_blank(),
        legend.text=element_text(size=8),
        panel.grid.major = element_blank(),
        legend.key = element_blank(),
        legend.background = element_blank(),
        axis.text.y=element_text(colour="black"),
        axis.text.x=element_text(colour="black"),
        text=element_text(family="Arial"))
```
###Saving and exporting your data 
In general, the best way to make a single file will be to export it using the ggsave() function. 
There are two main ways to get your plots out of R using ggplot2. 
ggsave() will save the most recent plot to your working directory
```{r}
ggplot(mpg, aes(displ, hwy)) + geom_point()

ggsave("my-plot.pdf")
#> Saving 7 x 4.32 in image
```
# Workshop 3

```{r}
#install.packages("usethis")
#library(usethis)
use_git_config(user.name = "Jadeasiu", user.email = "jadeasiu@hotmail.com")
gitcreds::gitcreds_set()
```
Assignment 1
```{r}
install.packages("wesanderson")
library("wesanderson")

zooxanthellae <- read.csv("zooxanthellae.csv")
zooxanthellae

theme(panel.border = element_blank(),
      plot.title = element_text(hjust=0.5),
      plot.subtitle = element_text(hjust=0.5),
      legend.position="right",
      legend.text=element_text(size=8),
      legend.key = element_blank(),
      legend.background = element_blank(),
      axis.text.y=element_text(colour="black"),
      axis.text.x=element_text(colour="black"),
      text=element_text(family="Calibri"))

Age <- as.character(zooxanthellae$Age)
Age <- factor(Age, levels = c("4 weeks", "9 weeks", "18 weeks", "37 weeks", "Adults"))

ggplot(data = zooxanthellae) +
  geom_bar(
    mapping = aes(x = Age, y = Occurrence, fill = Strain), 
    stat = "identity",
    position = "stack"
  ) +
  labs(
    title = "Abundance of two Symbiodinium strains in A. Tenuis",
    subtitle = "Magnetic Island, QLD",
    color = "Sybiodinium Strain"
  ) +
  scale_y_continuous(breaks = seq(0, 100, by = 10), expand=c(0,0), limits=c(0,100)) +
  scale_fill_manual(values = wes_palette("Moonrise3")) +
  theme(plot.title = element_text(hjust=0.5),
        plot.subtitle = element_text(hjust=0.5),
        panel.background = element_blank(),
        legend.position="right",
        legend.text=element_text(size=8),
        legend.key = element_blank(),
        legend.background = element_blank(),
        axis.text.y=element_text(colour="black"),
        axis.text.x=element_text(colour="black"),
        axis.line = element_line(colour = "black"),
        text=element_text(family="Calibri"))
```